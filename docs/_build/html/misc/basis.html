<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>17.1. Basis &#8212; Neutrino Notes</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/modify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/modify.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/js/jquery-fix.js"></script>
    <script src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="17.2. Decoherence" href="decoherence.html" />
    <link rel="prev" title="17. Other Topics" href="index.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({ TeX: { extensions: ["color.js","cancel.js", "AMSmath.js", "AMSsymbols.js"] }});
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
   cancel: ["Extension","cancel"]
   });
});
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
     skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
   }
});
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Queue(function() {
     var all = MathJax.Hub.getAllJax(), i;
     for(i=0; i < all.length; i += 1) {
         all[i].SourceElement().parentNode.className += ' has-jax';
     }
});
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
   processEscapes: true
}
});
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
"fast-preview": {
Chunks: {EqnChunk: 10000, EqnChunkFactor: 1, EqnChunkDelay: 0},
color: "inherit!important",
updateTime: 30, updateDelay: 6,
messageStyle: "none",
disabled: false
}
});
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
TeX: {
   Macros: {
     overlr: ['\\overset\\leftrightarrow{\#1}',1],
     overl: ['\\overset\leftarrow{\#1}',1],
     overr: ['\\overset\rightarrow{\#1}',1],
     bra: ['\\left\\langle \#1\\right|',1],
     ket: ['\\left| \#1\\right\\rangle',1],
     braket: ['\\langle \#1 \\mid \#2 \\rangle',2],
     avg: ['\\left< \#1 \\right>',1],
     slashed: ['\\cancel{\#1}',1],
     bold: ['\\boldsymbol{\#1}',1],
     sech: ['\\operatorname{sech}{\#1}',1],
     csch: ['\\operatorname{csch}{\#1}',1],
     Tr: ['\\operatorname{Tr}{\#1}',1]
   }
}
});
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>



<!-- Toggle Environment Begin -->
  <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .admonition-title").show();
        $(".toggle .admonition-title").click(function() {
            $(this).parent().children().not(".admonition-title").toggle(400);
            $(this).parent().children(".admonition-title").toggleClass("open");
        })
    });
    </script>
<!-- Toggle Environment End -->



 
  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Neutrino</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Table of Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../preliminary/index.html">1. Preliminary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../preliminary/commonsense.html">1.1. Common Sense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preliminary/physics.html">1.2. Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preliminary/quantum.html">1.3. Quantum Physics Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preliminary/math.html">1.4. Mathematics Related</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preliminary/questions.html">1.5. Questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mass/index.html">2. Masses of Neutrinos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mass/theory-mass.html">2.1. Theories of Neutrino Mass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mass/determine-mass.html">2.2. Determine Neutrino Mass</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../experiments/index.html">3. Experiments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../experiments/neutrino-sources.html">3.1. Neutrino Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../experiments/exp-concepts.html">3.2. Concepts in Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../experiments/exp-list.html">3.3. List of Neutrino Experiments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../oscillations/index.html">4. Oscillations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../oscillations/propagation.html">4.1. How Do Neutrinos Propagate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oscillations/two-flavor-three-flavor.html">4.2. Two-flavor and Three-flavor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oscillations/oscillations.html">4.3. Evidence of Oscillations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oscillations/vacuum.html">4.4. Vacuum Oscillation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oscillations/limit-circle.html">4.5. Oscillations and Limit Circle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../matter/index.html">5. Interaction With Matter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../matter/msw.html">5.1. MSW Effect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matter/msw-derivation.html">5.2. MSW Refraction, Resonance and Non-adiabacity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matter/parametric.html">5.3. Parametric Resonance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matter/matter-driven.html">5.4. Matter as Driving Energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matter/distorted-phase-effect.html">5.5. Distorted Phase Effect</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../coherent/index.html">6. Coherent Scattering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../coherent/coherent-scattering.html">6.1. Coherent Scattering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coherent/conserved-quantities.html">6.2. Conservations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../collective/index.html">7. Collective Behavior</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../collective/concepts.html">7.1. Collective Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collective/equation-of-motion.html">7.2. Equation of Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collective/intuitions.html">7.3. Intuitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collective/symmetric-models.html">7.4. Symmetric Neutrino Flavor Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collective/synchronization.html">7.5. Synchronization in Neutrino Oscillations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collective/linear-stability-analysis.html">7.6. Linear Stability Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collective/fast-modes.html">7.7. Fast Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collective/symmetries.html">7.8. Symmetries in Neutrino Oscillations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../instability/index.html">8. Instability</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../instability/bipolar.html">8.1. Bipolar Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../instability/multi-zenith-angle.html">8.2. Multi-Zenith-Angle Instability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../instability/multi-azimuth-angle.html">8.3. MAA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pictures/index.html">9. Pictures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../pictures/basics.html">9.1. Some Useful Physics Pictures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pictures/flavor-isospin.html">9.2. Flavor Isospin</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">10. Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/index.html#homogeneous-and-isotropic-neutrino-gas">10.1. Homogeneous and Isotropic Neutrino Gas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../resonances/index.html">11. Resonances in Neutrino Oscillations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../resonances/msw-resonance.html">11.1. MSW Resonance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resonances/parameteric-resonance.html">11.2. Parametric Resonance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resonances/resonance-in-general-matter-potential.html">11.3. Resonance in General Matter Potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resonances/matter-neutrino-resonance.html">11.4. Matter Neutrino Resonance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../statistical-physics/index.html">12. Statistical Physics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../statistical-physics/master-eqn.html">12.1. Neutrino Oscillation And Master Equation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../geometric-phase/index.html">13. Geometric Phase</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../geometric-phase/review.html">13.1. Review of Geometric Phases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geometric-phase/neutrino-oscillations-berry-phase.html">13.2. Neutrino Oscillations and Berry Phase</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../astrophysics/index.html">14. Astrophysics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../astrophysics/stars-as-neutrino-factories.html">14.1. Stars as Neutrino Factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astrophysics/supernova.html">14.2. Supernova</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astrophysics/merging-compact-objects.html">14.3. Merging Compact Objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gravity/index.html">15. Gravity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gravity/trajectory.html">15.1. Effect of Gravitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gravity/eom-in-gravitational-field.html">15.2. Equation of Motion in Gravitational Field</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cosmology/index.html">16. Neutrinos and Cosmology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cosmology/index.html#baryon-asymmetry-in-the-univserse">16.1. Baryon Asymmetry in the Univserse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cosmology/index.html#cosmic-neutrino-background">16.2. Cosmic Neutrino Background</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">17. Other Topics</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">17.1. Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="decoherence.html">17.2. Decoherence</a></li>
<li class="toctree-l2"><a class="reference internal" href="qualitative.html">17.3. Qualitative Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="cheatsheet.html">17.4. Neutrino Cheat Sheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html">17.5. Frequently Asked Questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ref.html">18. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement.html">19. Acknowledgement</a></li>
</ul>
<p class="caption"><span class="caption-text">WIP Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../research-notes/index.html">1. WIP Neutrino Physics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../research-notes/matter-stimulated/index.html">1.1. Matter Stimulated Oscillation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../research-notes/collective/index.html">1.2. Collective</a></li>
<li class="toctree-l2"><a class="reference internal" href="../research-notes/halo/index.html">1.3. Halo Effect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../research-notes/gravity/index.html">1.4. Gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../research-notes/group-meeting/index.html">1.5. Group Meeting</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Sections <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">17.1. Basis</a><ul>
<li><a class="reference internal" href="#rotation-of-states">17.1.1. Rotation of States</a></li>
<li><a class="reference internal" href="#rotation-of-pauli-matrices">17.1.2. Rotation of Pauli Matrices</a></li>
<li><a class="reference internal" href="#rotation-of-hamiltonian">17.1.3. Rotation of Hamiltonian</a></li>
<li><a class="reference internal" href="#examples-of-rotating-basis">17.1.4. Examples of Rotating Basis</a><ul>
<li><a class="reference internal" href="#rotate-from-vacuum-to-another-basis">17.1.4.1. Rotate From Vacuum to Another Basis</a></li>
<li><a class="reference internal" href="#constant-matter-eigen-basis">17.1.4.2. Constant Matter Eigen Basis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#refs-notes">17.1.5. Refs &amp; Notes</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: 17. Other Topics"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 17. Other Topics</span>
    </a>
  </li>
  <li>
    <a href="decoherence.html" title="Next Chapter: 17.2. Decoherence"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">17.2. Decoherence &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="basis">
<h1><span class="section-number">17.1. </span>Basis<a class="headerlink" href="#basis" title="Permalink to this headline">¶</a></h1>
<p>Calculating neutrino oscillations requires a lot of rotations between different bases.</p>
<div class="section" id="rotation-of-states">
<h2><span class="section-number">17.1.1. </span>Rotation of States<a class="headerlink" href="#rotation-of-states" title="Permalink to this headline">¶</a></h2>
<p>There are three most used bases, vacuum basis which diagonalizes the vacuum Hamiltonian, flavor basis where the flavor states stay, and instataneous matter basis which diagonializes the Hamiltonian with constant matter interaction or the instataneous matter interaction.</p>
<ul>
<li><p>The rotation from vacuum basis wavefunction <span class="math notranslate nohighlight">\(\Psi_v\)</span> to flavor basis <span class="math notranslate nohighlight">\(\Psi_f\)</span> is</p>
<div class="math notranslate nohighlight">
\[\Psi_f = R_{v2f}(\theta_v) \Psi_v,\]</div>
<p>where the rotation is</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_{v2f}(\theta_v) = \begin{pmatrix} \cos\theta_v &amp; \sin \theta_v \\ -\sin \theta_v &amp; \cos \theta_v \end{pmatrix}.\end{split}\]</div>
</li>
<li><p>The rotation from matter basis wavefunction <span class="math notranslate nohighlight">\(\Psi_m\)</span> to flavor basis wavefunction <span class="math notranslate nohighlight">\(\Psi_f\)</span> is</p>
<div class="math notranslate nohighlight">
\[\Psi_f = R_{m2f}(\theta_m) \Psi_m,\]</div>
<p>where the roation is</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_{m2f}(\theta_m) = \begin{pmatrix} \cos\theta_m &amp; \sin \theta_m \\ -\sin \theta_m &amp; \cos \theta_m \end{pmatrix}.\end{split}\]</div>
<p>The matter mixing angle is determined by the matter potential <span class="math notranslate nohighlight">\(\lambda = \sqrt{2}G_F n_e\)</span>,</p>
<div class="math notranslate nohighlight">
\[\tan 2\theta_m = \frac{\sin 2\theta_v}{\cos 2\theta_v - \lambda/\omega},\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega = \delta m^2 /2E\)</span> is the vacuum frequency of neutrinos.</p>
</li>
</ul>
<div class="note admonition">
<p class="admonition-title">Rotate Twice</p>
<p>A rotation from vacuum basis to flavor basis then to matter basis is simply the addition of the two rotation, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_{v2f2m}(\theta_v,\theta_m) = \begin{pmatrix} \cos(\theta_v - \theta_m) &amp; \sin ( \theta_v - \theta_m ) \\ -\sin (\theta_v-\theta_m) &amp; \cos (\theta_v - \theta_m) \end{pmatrix}.\end{split}\]</div>
</div>
</div>
<div class="section" id="rotation-of-pauli-matrices">
<h2><span class="section-number">17.1.2. </span>Rotation of Pauli Matrices<a class="headerlink" href="#rotation-of-pauli-matrices" title="Permalink to this headline">¶</a></h2>
<p>Rotate <span class="math notranslate nohighlight">\(\sigma_1\)</span> from vacuum basis to flavor basis,</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;R_{v2f}(\theta) \sigma_1 R_{v2f}^{\dagger} \\
=&amp; \sin 2\theta \sigma_3 + \cos 2\theta \sigma_1.\end{split}\]</div>
<p>Rotate <span class="math notranslate nohighlight">\(\sigma_3\)</span> from vacuum basis to flavor basis,</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;R_{v2f}(\theta) \sigma_3 R_{v2f}^{\dagger} \\
=&amp;  \begin{pmatrix} \cos \theta &amp; \sin \theta \\ -\sin \theta &amp; \cos\theta \end{pmatrix} \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; -1 \end{pmatrix} \begin{pmatrix} \cos \theta &amp; -\sin \theta \\ \sin \theta &amp; \cos\theta \end{pmatrix} \\
=&amp; \cos 2\theta \sigma_3 - \sin 2\theta \sigma_1.\end{split}\]</div>
</div>
<div class="section" id="rotation-of-hamiltonian">
<h2><span class="section-number">17.1.3. </span>Rotation of Hamiltonian<a class="headerlink" href="#rotation-of-hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>Given the vacuum basis Hamiltonian <span class="math notranslate nohighlight">\(H_v\)</span>, we can rotation it to flavor basis by using the rotation <span class="math notranslate nohighlight">\(R_{v2f}(\theta_v)\)</span></p>
<div class="math notranslate nohighlight">
\[H_f = R_{v2f}(\theta_v) H_v R_{v2f}^{-1}(\theta_v).\]</div>
<p>Similarly, the flavor basis Hamiltonian <span class="math notranslate nohighlight">\(H_f\)</span> can also be calculated from matter basis Hamiltonian <span class="math notranslate nohighlight">\(H_m\)</span> ,</p>
<div class="math notranslate nohighlight">
\[H_f = R_{m2f}(\theta_m) H_m R_{v2f}^{-1}(\theta_m).\]</div>
<div class="note admonition">
<p class="admonition-title">Vacuum Basis Hamiltonian</p>
<p>The Hamiltonian in this basis is composed of vacuum Hamiltonian which is diagonalized and the matter potential rotated from flavor basis,</p>
<div class="math notranslate nohighlight">
\[\begin{split}H_v &amp;= -\frac{\omega}{2} \sigma_3 + \frac{\lambda}{2} \begin{pmatrix} \cos \theta &amp; -\sin \theta \\ \sin \theta &amp; \cos\theta \end{pmatrix}  \sigma_3 \begin{pmatrix} \cos \theta &amp; \sin \theta \\ -\sin \theta &amp; \cos\theta \end{pmatrix} \\
&amp;= -\frac{\omega}{2} \sigma_3 + \frac{\lambda}{2}\cos 2\theta_v \sigma_3 + \frac{\lambda}{2} \sin 2\theta_v \sigma_1.\end{split}\]</div>
</div>
<div class="note admonition">
<p class="admonition-title">Flavor Basis Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H_f = - \frac{\omega}{2} \cos 2\theta \sigma_3 +  \frac{\omega}{2} \sin 2\theta \sigma_1 +  \frac{\lambda}{2} \sigma_3.\]</div>
</div>
<p>As a consistancy check, we now rotate Hamiltonian in vacuum basis to flavor basis.</p>
<div class="math notranslate nohighlight">
\[\begin{split}H_f =&amp; \begin{pmatrix} \cos \theta &amp; \sin \theta \\ -\sin \theta &amp; \cos\theta \end{pmatrix} H_v \begin{pmatrix} \cos \theta &amp; -\sin \theta \\ \sin \theta &amp; \cos\theta \end{pmatrix}\\
=&amp; \left(-\frac{\omega}{2} + \frac{\lambda}{2} \cos 2\theta \right) \begin{pmatrix} \cos \theta &amp; \sin \theta \\ -\sin \theta &amp; \cos\theta \end{pmatrix} \sigma_3 \begin{pmatrix} \cos \theta &amp; -\sin \theta \\ \sin \theta &amp; \cos\theta \end{pmatrix} \\
&amp;+ \frac{\lambda}{2} \sin 2\theta \begin{pmatrix} \cos \theta &amp; \sin \theta \\ -\sin \theta &amp; \cos\theta \end{pmatrix} \sigma_1 \begin{pmatrix} \cos \theta &amp; -\sin \theta \\ \sin \theta &amp; \cos\theta \end{pmatrix} \\
=&amp; \left(-\frac{\omega}{2} + \frac{\lambda}{2} \cos 2\theta \right) ( \cos 2\theta \sigma_3 - \sin 2\theta \sigma_1 ) + \frac{\lambda}{2}\sin 2\theta ( \sin 2\theta \sigma_3 + \cos 2\theta \sigma_1 ) \\
=&amp; -\frac{\omega}{2} \cos 2\theta \sigma_3 + \frac{\omega}{2}\sin 2\theta \sigma_1 + \frac{\lambda}{2} ( \cos^2 2\theta + \sin ^2 2\theta ) \sigma_3 \\
=&amp; -\frac{\omega}{2} \cos 2\theta \sigma_3 + \frac{\omega}{2}\sin 2\theta \sigma_1 + \frac{\lambda}{2}\sigma_3 .\end{split}\]</div>
<div class="hint admonition">
<p class="admonition-title">Numerical Calculation of The Rotations</p>
<p>To write clean code, it is better to define and test there rotations first.</p>
</div>
</div>
<div class="section" id="examples-of-rotating-basis">
<h2><span class="section-number">17.1.4. </span>Examples of Rotating Basis<a class="headerlink" href="#examples-of-rotating-basis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rotate-from-vacuum-to-another-basis">
<h3><span class="section-number">17.1.4.1. </span>Rotate From Vacuum to Another Basis<a class="headerlink" href="#rotate-from-vacuum-to-another-basis" title="Permalink to this headline">¶</a></h3>
<p>In vacuum basis, Hamiltonian with matter interaction is</p>
<div class="math notranslate nohighlight">
\[H_v = -\frac{\omega}{2} \sigma_3 + \frac{\lambda}{2}\cos 2\theta_v \sigma_3 + \frac{\lambda}{2} \sin 2\theta_v \sigma_1,\]</div>
<p>where we have got a contribution of <span class="math notranslate nohighlight">\(\sigma_3\)</span> from matter interaction. By carefully defining a transformation that removes this contribution, we can define a new basis in which the wavefunction is <span class="math notranslate nohighlight">\(\Psi_b\)</span>, which is related to the vacuum basis wavefunction in the following way,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}\psi_{v1} \\ \psi_{v2} \end{pmatrix}  = \begin{pmatrix}
e^{-i \eta(x) x} &amp; 0 \\  0 &amp; e^{i \eta(x) x}
\end{pmatrix} \begin{pmatrix}\psi_{b1} \\ \psi_{b2} \end{pmatrix},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta(x)\)</span> is a function of position. We can find the requirement of it by plugging the wavefunction into Schrodinger equation, which results in</p>
<div class="math notranslate nohighlight">
\[\eta + x \frac{d\eta }{dx} = \frac{\lambda}{2} \cos 2\theta_v.\]</div>
<div class="note admonition">
<p class="admonition-title">Derivation of <span class="math notranslate nohighlight">\(\eta\)</span></p>
<p>Plug the transformation into Schrodinger equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathrm{LHS} =&amp; i \frac{d}{dx} \left[  \begin{pmatrix} e^{-i\eta(x) x} &amp; 0 \\  0 &amp; e^{i\eta(x) x} \end{pmatrix}  \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix} \right] \\
=&amp; i \begin{pmatrix}  - i \eta(x) e^{-i \eta(x) x} - i x \frac{d\eta(x)}{dx} e^{-i \eta(x) x}  &amp; 0 \\  0 &amp; i\eta(x) e^{i\eta(x) x} + i x \frac{d\eta(x)}{dx} e^{i\eta(x)x}  \end{pmatrix}  \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix}  \\
&amp; +  i \begin{pmatrix} e^{-i\eta(x) x} &amp; 0 \\  0 &amp; e^{i\eta(x) x}  \end{pmatrix} \frac{d}{dx} \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix}\end{split}\]</div>
<p>Multiplying on both sides of the equation the Hermitian conjugate of the transformation matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix} e^{i\eta(x)x} &amp; 0 \\ 0 &amp; e^{-i \eta(x)x} \end{pmatrix},\end{split}\]</div>
<p>the two sides becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix} e^{i\eta(x)x} &amp; 0 \\ 0 &amp; e^{-i \eta(x)x} \end{pmatrix}\mathrm{LHS} &amp; = i \begin{pmatrix} - i\eta{x} - i x \frac{d\eta(x)}{dx} &amp;  0 \\ 0 &amp; i \eta(x) + i x \frac{d\eta(x)}{dx} \end{pmatrix}  \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix} + i \frac{d}{dx} \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix}  \\
\begin{pmatrix} e^{i\eta(x)x} &amp; 0 \\ 0 &amp; e^{-i \eta(x)x} \end{pmatrix} \mathrm{RHS} &amp; = \left( - \frac{\omega}{2} \sigma_3 + \frac{\lambda(x)}{2} \cos 2\theta_v \sigma_3 + \frac{\lambda(x)}{2} \sin 2\theta_v \begin{pmatrix} 0 &amp; e^{2i\eta(x)x} \\ e^{-2i\eta(x)x} &amp; 0 \end{pmatrix}  \right)  \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix} .\end{split}\]</div>
<p>We choose the condition that</p>
<div class="math notranslate nohighlight">
\[\eta(x) + x \frac{d\eta(x)}{dx} = \frac{\lambda(x)}{2} \cos 2\theta_v,\]</div>
<p>which removes the second term in the Hamiltonian in vacuum basis. Finally we have the equation of motion in this new basis</p>
<div class="math notranslate nohighlight">
\[\begin{split}i \frac{d}{dx} \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix} = \left( - \frac{\omega}{2} \sigma_3 + \frac{\lambda(x)}{2} \sin 2\theta_v \begin{pmatrix} 0 &amp; e^{2i\eta(x)x} \\ e^{-2i\eta(x)x} &amp; 0 \end{pmatrix} \right) \begin{pmatrix} \psi_{b1} \\ \psi_{b2} \end{pmatrix}.\end{split}\]</div>
<p>We could even remove all the <span class="math notranslate nohighlight">\(\sigma_3\)</span> terms using this method by choosing</p>
<div class="math notranslate nohighlight">
\[\eta(x) + x \frac{d\eta(x)}{dx} = -\frac{\omega}{2} + \frac{\lambda(x)}{2} \cos 2\theta_v.\]</div>
</div>
<p>The general solution of <span class="math notranslate nohighlight">\(\eta(x)\)</span> is</p>
<div class="math notranslate nohighlight">
\[\eta(x) = \frac{Constant}{x} + \frac{1}{x} \int_1^x \frac{\cos 2\theta_v}{2} \lambda(\tau) d\tau,\]</div>
<p>where the constant can always be set to 0, which tells us that</p>
<div class="math notranslate nohighlight">
\[\eta(x) = \frac{1}{x} \int_1^x \frac{\cos 2\theta_v}{2} \lambda(\tau) d\tau .\]</div>
<div class="note admonition">
<p class="admonition-title">Constant Matter Density</p>
<p>As a check, for constant <span class="math notranslate nohighlight">\(\lambda\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\eta(x) = \frac{\cos 2\theta_v }{2x} \lambda ( x-1 ).\]</div>
</div>
<p>In this new basis, the Hamiltonian becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}H_b &amp;= - \frac{\omega}{2} \sigma_3 + \frac{\lambda}{2} \sin 2\theta_v \begin{pmatrix} 0 &amp; e^{i 2\eta(x) x} \\ e^{ - i 2\eta(x) x} &amp; 0  \end{pmatrix} \\
&amp; =  - \frac{\omega}{2} \sigma_3 + \frac{\lambda}{2}\sin 2\theta_v \cos ( 2\eta(x) x )\sigma_1 - \frac{\lambda}{2} \sin 2\theta_v \sin (2\eta(x) x) \sigma_2.\end{split}\]</div>
</div>
<div class="section" id="constant-matter-eigen-basis">
<h3><span class="section-number">17.1.4.2. </span>Constant Matter Eigen Basis<a class="headerlink" href="#constant-matter-eigen-basis" title="Permalink to this headline">¶</a></h3>
<p>For a Hamiltonian with matter interection,</p>
<div class="math notranslate nohighlight">
\[H_v = -\frac{\omega}{2} \sigma_3 + \frac{\lambda}{2}\cos 2\theta_v \sigma_3 + \frac{\lambda}{2} \sin 2\theta_v \sigma_1,\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda(x) = \lambda_0 + \lambda_1(x)\)</span>. We rotate it into constant matter basis where the Hamiltonian is diagonalized with only <span class="math notranslate nohighlight">\(\lambda_0\)</span>,</p>
<div class="math notranslate nohighlight">
\[H_m = R_{v2m} H_v R_{v2m}^\dagger,\]</div>
<p>where <span class="math notranslate nohighlight">\(U\)</span> rotates the state from vacuum basis to constant matter basis.</p>
<p>In general the Hamiltonian after the rotation is written in a form</p>
<div class="math notranslate nohighlight">
\[H_m = H_0 + R_{f2m}^\dagger \lambda_{1,f}(x) R_{f2m},\]</div>
<p>in which <span class="math notranslate nohighlight">\(R_{f2m}\)</span> is the rotation from flavor basis to constant matter basis and <span class="math notranslate nohighlight">\(\lambda_{1,f}\)</span> is the perturbation of matter profile in flavor basis. We also have</p>
<div class="math notranslate nohighlight">
\[\begin{split}H_0 = \begin{pmatrix} \omega_{m1} &amp; 0 \\ 0 &amp; \omega_{m2} \end{pmatrix}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\lambda_{1,f}(x) = \begin{pmatrix} \delta\lambda &amp; 0 \\ 0 &amp; 0  \end{pmatrix}.\end{split}\]</div>
<div class="hint admonition">
<p class="admonition-title">Another Form of Matter Potential</p>
<p>For the perturbation we could also make it traceless without changing the probabilities.</p>
</div>
<div class="hint admonition">
<p class="admonition-title">Position Dependent Rotation</p>
<p>If the rotation is position dependent, i.e., the matter profile <span class="math notranslate nohighlight">\(\lambda_0\)</span> is not position independent, we have, in general,</p>
<div class="math notranslate nohighlight">
\[H_m = H_0 - i R_{f2m}^\dagger \frac{d}{dx} R_{f2m} + R_{f2m}^\dagger \lambda_1(x) R_{f2m}.\]</div>
<p>In the case of discussion here, <span class="math notranslate nohighlight">\(\frac{d}{dx} R_{f2m}=0\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="refs-notes">
<h2><span class="section-number">17.1.5. </span>Refs &amp; Notes<a class="headerlink" href="#refs-notes" title="Permalink to this headline">¶</a></h2>
</div>
</div>


    </div>
      
  </div>
</div>


<div class="container" style="border-top:solid 1px black;margin-top:10px;padding-top:10px;padding-bottom:10px;">
<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'neuphysics'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the
        <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
</div>

<hr>


<div class="container" style="border-top:solid 1px black;margin-top:10px;padding-top:10px;padding-bottom:10px;">
    <p class="pull-right">


        <a href="#"><span class="label label-info">Back to top</span></a>

    </p>
    <p>
        <span>© <a href="https://leima.is">2021, Lei Ma  <span class="glyphicon glyphicon-link" aria-hidden="true"></span></a> </span> |
        <span>Created with
        <a href="http://sphinx.pocoo.org/">Sphinx</a> and <span class="glyphicon glyphicon-heart" aria-hidden="true"></span>.
        </span>|
        <span><span class="glyphicon glyphicon-cloud" aria-hidden="true"></span>
        <a href="https://github.com/NeuPhysics/neutrino">On GitHub</a>
        </span>|
        <span><span class="glyphicon glyphicon-book" aria-hidden="true"></span>
              <a href="http://physics.leima.is">Physics Notebook</a>
        </span>
        <span><span class="glyphicon glyphicon-book" aria-hidden="true"></span>
              <a href="http://statisticalphysics.leima.is">Statistical Mechanics Notebook</a>
        </span>
        <span><span class="glyphicon glyphicon-book" aria-hidden="true"></span>
            <a href="http://datumorphism.leima.is>Computational Methods</a>
        </span>
         |
        <span><span class="glyphicon glyphicon-list" aria-hidden="true"></span>
        <a href="/genindex.html">Index</a>
     </span> |
       <span><span class="glyphicon glyphicon-paperclip" aria-hidden="true"></span>
       <a href="../_sources/misc/basis.rst.txt"
      rel="nofollow">Page Source</a>
      </span>


    </p>

    <hr>

    <script>
        window.jQuery || document.write('<script src="_static/js/vendor/jquery-1.9.1.min.js"><\/script>')
    </script>

</div>

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-66327435-2']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
    })();
</script>
 
  </body>
</html>